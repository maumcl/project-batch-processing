{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.1", "generated_at": "2025-01-29T18:21:57.105445Z", "invocation_id": "d0342243-1118-417e-89dd-1178da2d97bc", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-29T18:21:26.048572Z", "completed_at": "2025-01-29T18:21:26.063932Z"}, {"name": "execute", "started_at": "2025-01-29T18:21:26.064611Z", "completed_at": "2025-01-29T18:21:27.908781Z"}], "thread_id": "Thread-1", "execution_time": 1.863671064376831, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "gcp-streaming-pipeline", "job_id": "53e7a7fc-2f77-4b8f-8f6b-76b2e8931965", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.project_batch_processing.transformed_data", "compiled": true, "compiled_code": "-- The transformations include:\n-- 1. Converting Unix timestamps (Start_time, End_time) to DATETIME.\n-- 2. Converting distance from miles to kilometers.\n-- 3. Converting temperature from Fahrenheit to Celsius.\n-- 4. Handling missing values in 'Weather_Condition' and 'Sunrise_Sunset' columns.\n-- 5. Replacing empty strings with NULL where applicable.\n-- 6. Creating a new model with the transformed data.\n\n\n  SELECT\n    ID,\n    DATETIME(TIMESTAMP_SECONDS(Start_time)) AS Start_datetime, \n    DATETIME(TIMESTAMP_SECONDS(End_time)) AS End_datetime,     \n    distance_mi,\n    distance_mi * 1.60934 AS distance_km,  -- Conversion: Miles to Kilometers.\n    temperature_f,\n    (temperature_f - 32) * 5/9 AS temperature_c,  -- Conversion: Fahrenheit to Celsius.\n    NULLIF(Weather_Condition, '') AS Weather_Condition,  \n    NULLIF(Sunrise_Sunset, '') AS Sunrise_Sunset,\n    NULLIF(Description, '') AS Description,  \n    NULLIF(Street, '') AS Street,  \n    NULLIF(City, '') AS City,  \n    NULLIF(County, '') AS County,  \n    NULLIF(State, '') AS State,  \n    NULLIF(Zipcode, '') AS Zipcode,  \n    NULLIF(Country, '') AS Country,  \n    NULLIF(Timezone, '') AS Timezone,  \n    NULLIF(Airport_Code, '') AS Airport_Code\n  FROM\n    `gcp-streaming-pipeline.project_parquet.cab_trips`", "relation_name": "`gcp-streaming-pipeline`.`project_parquet`.`transformed_data`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-29T18:21:27.915054Z", "completed_at": "2025-01-29T18:21:27.920559Z"}, {"name": "execute", "started_at": "2025-01-29T18:21:27.921081Z", "completed_at": "2025-01-29T18:21:43.477417Z"}], "thread_id": "Thread-1", "execution_time": 15.56470775604248, "adapter_response": {"_message": "MERGE (4.6m rows, 2.9 GiB processed)", "code": "MERGE", "rows_affected": 4593150, "bytes_processed": 3097943414, "bytes_billed": 3098542080, "location": "US", "project_id": "gcp-streaming-pipeline", "job_id": "ff4a8e56-2ad8-4966-af1e-a623ffebaa62", "slot_ms": 631490}, "message": "MERGE (4.6m rows, 2.9 GiB processed)", "failures": null, "unique_id": "model.project_batch_processing.uber_incremental", "compiled": true, "compiled_code": "\n\nwith raw_uber_data as (\n    select * from `gcp-streaming-pipeline.project_parquet.transformed_data`\n)\n\nSELECT\n    ID,\n    Start_datetime,\n    EXTRACT(YEAR FROM Start_datetime) as year,\n    End_datetime,     \n    distance_mi,\n    distance_km,\n    temperature_f,\n    Weather_Condition,  \n    Sunrise_Sunset,\n    Description,  \n    Street,  \n    City,  \n    County,  \n    State,  \n    Zipcode,  \n    Country,  \n    Timezone,  \n    Airport_Code\n    -- Add more transformations here as necessary\nfrom raw_uber_data\n\n\n    -- Incremental logic: filter only rows where year > 2019\n    where EXTRACT(YEAR FROM Start_datetime) > 2019\n", "relation_name": "`gcp-streaming-pipeline`.`project_parquet`.`uber_incremental`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-29T18:21:43.490132Z", "completed_at": "2025-01-29T18:21:43.500133Z"}, {"name": "execute", "started_at": "2025-01-29T18:21:43.501477Z", "completed_at": "2025-01-29T18:21:50.166224Z"}], "thread_id": "Thread-1", "execution_time": 6.67944598197937, "adapter_response": {"_message": "CREATE TABLE (404.2k rows, 271.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 404206, "bytes_processed": 284524385, "bytes_billed": 285212672, "location": "US", "project_id": "gcp-streaming-pipeline", "job_id": "d61c08ae-7fc1-4487-bce4-6c0f22909231", "slot_ms": 32972}, "message": "CREATE TABLE (404.2k rows, 271.3 MiB processed)", "failures": null, "unique_id": "model.project_batch_processing.uber_monthly_aggregates", "compiled": true, "compiled_code": "\n\nSELECT \n    DATE_TRUNC(Start_datetime, MONTH) AS ride_month,\n    City,\n    COUNT(ID) AS total_rides,\n    AVG(distance_km) AS avg_distance\nFROM \n    `gcp-streaming-pipeline.project_parquet.transformed_data`\nGROUP BY \n    ride_month, \n    City\nORDER BY \n    ride_month, \n    City", "relation_name": "`gcp-streaming-pipeline`.`project_parquet`.`uber_monthly_aggregates`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-29T18:21:50.170653Z", "completed_at": "2025-01-29T18:21:50.174093Z"}, {"name": "execute", "started_at": "2025-01-29T18:21:50.174635Z", "completed_at": "2025-01-29T18:21:57.029101Z"}], "thread_id": "Thread-1", "execution_time": 6.860355377197266, "adapter_response": {"_message": "CREATE TABLE (5.0 rows, 156.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 5, "bytes_processed": 163541857, "bytes_billed": 163577856, "location": "US", "project_id": "gcp-streaming-pipeline", "job_id": "0bdc565f-ec39-495d-95d3-604cfa132f89", "slot_ms": 5778}, "message": "CREATE TABLE (5.0 rows, 156.0 MiB processed)", "failures": null, "unique_id": "model.project_batch_processing.uber_top_cities", "compiled": true, "compiled_code": "\n\nSELECT \n    City,\n    COUNT(ID) AS total_rides\nFROM \n    `gcp-streaming-pipeline.project_parquet.transformed_data`\nGROUP BY \n    City\nORDER BY \n    total_rides DESC\nLIMIT 5", "relation_name": "`gcp-streaming-pipeline`.`project_parquet`.`uber_top_cities`", "batch_results": null}], "elapsed_time": 32.676246643066406, "args": {"vars": {}, "log_format": "default", "log_level_file": "debug", "show_resource_report": false, "project_dir": "/home/mauricio/git/project-batch-processing", "strict_mode": false, "select": [], "empty": false, "use_colors_file": true, "static_parser": true, "require_yaml_configuration_for_mf_time_spines": false, "favor_state": false, "invocation_command": "dbt run", "partial_parse_file_diff": true, "printer_width": 80, "partial_parse": true, "log_path": "/home/mauricio/git/project-batch-processing/logs", "log_file_max_bytes": 10485760, "defer": false, "indirect_selection": "eager", "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "which": "run", "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "quiet": false, "introspect": true, "profiles_dir": "/home/mauricio/.dbt", "exclude": [], "log_level": "info", "print": true, "send_anonymous_usage_stats": true, "require_batched_execution_for_custom_microbatch_strategy": false, "populate_cache": true, "require_resource_names_without_spaces": false, "require_nested_cumulative_type_params": false, "state_modified_compare_more_unrendered_values": false, "state_modified_compare_vars": false, "write_json": true, "macro_debugging": false, "use_colors": true, "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": false, "version_check": true}}